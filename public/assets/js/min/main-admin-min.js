function handleDragStart(e){this.classList.add("dragging"),dragSrcEl=this,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.innerHTML)}function handleDragOver(e){return e.preventDefault&&e.preventDefault(),e.dataTransfer.dropEffect="move",!1}function handleDragEnter(e){this.classList.add("drag-over")}function handleDragLeave(e){this.classList.remove("drag-over")}function handleDrop(e){function a(e){for(var a=e.parentNode.parentNode.getElementsByTagName("li"),t=a.length,r,n=0;t>n;n++)if(a[n]==e)return r=n,r+1}return e.stopPropagation&&e.stopPropagation(),dragSrcEl!=this&&(dragSrcEl.innerHTML=this.innerHTML,this.innerHTML=e.dataTransfer.getData("text/html"),[].forEach.call(cols,function(e){e.classList.remove("drag-over"),e.classList.remove("dragging");var t=a(e),r=e.getElementsByClassName("sort-order")[0];r.value=t}),button.classList.remove("inactive"),button.classList.add("active"),e.preventDefault()),!1}function handleDragEnd(e){return[].forEach.call(cols,function(e){e.classList.remove("drag-over"),e.classList.remove("dragging")}),!1}$(function(){$(".date-select").datepicker({format:"yyyy-mm-dd",autoclose:!0}).on("changeDate",function(){$(".datepicker").hide()}),$("form[data-confirm]").submit(function(){return confirm($(this).attr("data-confirm"))?void 0:!1}),$(".move-up").on("click",function(){var e=$(this).closest(".draggable"),a=e.prev(),t=e.find(".sort-order"),r=parseInt(t.val()),n=e.prev().find(".sort-order"),o=parseInt(n.val());e.insertBefore(a).fadeIn(),1!=r&&t.val(r-1),n.val(o+1),$(".button").removeClass("inactive").addClass("active")}),$(".move-down").on("click",function(){var e=$(this).closest(".draggable"),a=e.next(),t=e.find(".sort-order"),r=parseInt(t.val()),n=e.next().find(".sort-order"),o=parseInt(n.val());e.insertAfter(a).fadeIn(300),t.val(r+1),n.val(o-1),$(".button").removeClass("inactive").addClass("active")})});var dragSrcEl=null,button=document.getElementById("submit"),cols=document.querySelectorAll(".draggable");[].forEach.call(cols,function(e){e.addEventListener("dragstart",handleDragStart,!1),e.addEventListener("dragenter",handleDragEnter,!1),e.addEventListener("dragover",handleDragOver,!1),e.addEventListener("dragleave",handleDragLeave,!1),e.addEventListener("dragend",handleDragEnd,!1),e.addEventListener("drop",handleDrop,!1)}),function(){var e=$("[data-preview]");e.each(function(e,a){var t=$(a);t.on("click",function(e){var a=t.data("preview"),r=$("#"+a),n=r.val(),o=$(t.attr("href"));o.html("<p>...loading preview</p>");var d=$.post("/markdown",{text:n}).done(function(e){o.html(e)})})})}();